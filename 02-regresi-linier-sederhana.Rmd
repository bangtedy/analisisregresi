# Regresi Linier Sederhana 

Bab ini akan membahas regresi linier sederhana. Istilah regresi sederhana tidak merujuk pada kenaifan penelitiannya tetapi merujuk pada model yang hanya terdiri dari satu variabel respons dan satu variabel prediktor.

Situasi ini sering terjadi pada penelitian sains. Misalnya seorang peneliti ingin memprediksi laju reaksi kimia karena perubahan temperatur, atau ingin mengetahui hubungan antara perubahan diet dengan tingkat kolesterol pada seseorang. Jika dapat diasumsikan bahwa variabel-variabel ini terhubung secara linier, kita dapat menggunakan regresi linier sederhana untuk mengkuantifikasi hubungan ini.

Analisis regresi digunakan ketika solusi eksak tidak tersedia, dalam arti kita tidak akan dapat menemukan nilai tunggal yang dapat mencakup secara lengkap hubungan antara variabel respons dengan prediktornya. Sehingga disini kita mencoba memprediksi setepat mungkin variabel respons atau memprediksi dengan kesalahan terkecil.

Untuk mencapai tujuan ini, kita menganalisis pola-pola variabilitas pada variabel respons dan mencoba melihat apakah variabilitas ini dapat diprediksi dari variabilitas prediktornya.

## Model Regresi Linier Sederhana 

Model regresi linier sederhana dapat dituliskan sebagai berikut:

\begin{equation} 
y_i=\beta_0 + \beta_1x_i+ \epsilon_i
(\#eq:persamaan-umum)
\end{equation}

Regresi sederhana mengindikasikan hanya ada satu variabel prediktor x untuk menduga variabel respons y. Linier disini diartikan modelnya linier pada parameternya dalam hal ini $\beta_0$ dan $\beta_1$. Jadi model $y_i = \beta_0 + \beta_1{x_i}^2 + \epsilon_i$ adalah linier pada $\beta_0$ dan $\beta_1$, sementara model $y_i = \beta_0 + e^{\beta_ix_i} + \epsilon_i$ tidak linier.

Misalkan kita memiliki pasangan-pasangan data sampel sebanyak n yang diambil secara acak dari populasi yang lebih besar $(x_1,y_1), (x_2,y_2), ⋯, (x_n,y_n)$. Tujuan dari analisis regresi linier adalah menemukan model terbaik yaitu menemukan nilai $\beta_0$ and $\beta_1$ yang menghasilkan garis paling cocok dengan titik-titik data yang kita punyai. 

Dengan kata lain tujuan dari analisis regresi adalah mengestimasi koefisien regresi untuk variabel prediktor sehingga didapatkan nilai dugaan variabel respons sedekat mungkin nilainya dengan nilai pengamatan aktualnya. 

Di dalam analisis regresi, model terbaik ditunjukkan oleh garis lurus yang menghubungkan rata-rata variabel prediktor dengan variabel respons sedemikian rupa sehingga jumlah kuadrat kesalahan (jarak vertikal antara titik-titik data pengamatan aktual $y_i$ dengan nilai dugaannya $\hat y_i$) minimal. 

Untuk memperoleh nilai dugaan $\beta_0$ dan $\beta_1$ yang paling cocok, kita menggunakan metode kuadrat terkecil (*method of least squares*). Dengan pendekatan kuadrat terkecil, kita mencari nilai dugaan $\beta_0$ dan $\beta_1$ yang meminimalkan jumlah kuadrat residu/kesalahan ($y_i-\hat y_i$).

### Kasus 1: Penjualan Motor dan Pertumbuhan Pendapatan Perkapita

Kita akan melanjutkan kasus hubungan antara penjualan motor dengan pendapatan pada Bab 1 sebelumnya sebagai ilustrasi regresi linier sederhana. Data dapat diunduh di [sini](https://drive.google.com/file/d/1Aa6A0KkXXINoDkdNJSnYUY5Y0E1xnrOb/view?usp=sharing). Langkah awal untuk melihat bagaimana hubungan antar variabel adalah membuat diagram pencar.

Plot sangat penting di dalam regresi. Pemeriksaan diagram pencar secara teliti harus mendahului penghitungan regresi. Diagram pencar dapat mengindikasikan apakah model regresi yang diinginkan mungkin masuk akal atau tidak. Kesepakatan dalam membuat diagram pencar, variabel $x$ sebagai variabel penjelas diplot pada sumbu horisontal. Varibel $y$ sebagai variabel respons diplot pada sumbu vertikal. 

Untuk membuat diagram pencar, hal pertama yang harus dilakukan adalah memasukkan data ke dalam R, mengecek apakah data yang kita masukkan sudah betul dan memanggil *library* yang relevan dengan model yang akan dibuat.

```{r, echo=TRUE}
# memanggil data dalam bentuk teks ke dalam R
PJMotor <- read.delim("PJMotor.txt") 
PJMotor <- as.data.frame(PJMotor)

```

```{r, echo=TRUE}
# untuk melihat beberapa baris data teratas
head(PJMotor) 
```

```{r, echo=TRUE}
# untuk melihat beberapa baris data terakhir
tail(PJMotor) 
```

Perintah ```plot(x,y)``` di dalam R adalah untuk membuat plot antara variabel respons dengan variabel prediktor. Hasilnya ditampilkan pada Gambar 2.1.

```{r, echo=TRUE}
#membuat diagram pencar
plot(x,y) 

```


Di dalam R model regresi linier sederhana dapat diperoleh dengan perintah ```lm(y~x)```. Tanda ~ dapat diartikan $y$ dijelaskan oleh $x$. Fungsi ini mengestimasi koefisien regresi model linier dengan metode kuadrat terkecil (*the least squares method*). 

Semisal modelnya kita beri nama **model penjualan motor (mpm)**, yang memodelkan hubungan antara penjualan motor ($y$) dengan pertumbuhan pendapatan ($x$), maka model ini dapat diperoleh dengan perintah:

```{r, echo=TRUE}
mpm <- lm(y ~ x)
# Perhatikan tanda panah ke kiri. 
# Intersep dan slope secara default diestimasi. 
# Bandingkan dengan perintah untuk mendapatkan diagram pencar. 
```

Perintah ini sama dengan persamaan dibawah:

$$ y = β_0 + β_1x + ε $$

Kita kemudian menggunakan perintah ```summary()``` untuk menampilkan luarannya. Hasilnya adalah sebagai berikut:

```{r, echo=TRUE}
# perintah summary() untuk mengekstrak hasil regresi
summary (mpm) 
```

Hasil regresi menunjukkan nilai dugaan intersep garis regresi $\hat \beta_0$ = -1.210 (SE= 2.088), p-value = 0.57 (tidak signifikan). Sedangkan nilai dugaan $\hat \beta_1$ = 1.733 (SE = 0.525) dan p-valuenya (menguji hipotesis nol bahwa $\beta_1$ = 0) kecil, konsisten dengan bukti persebaran data yang cenderung linier. 

Di dalam R, kita bisa dengan mudah menambahkan nilai-nilai dugaan dan residu ke dalam data dengan menggunakan perintah ```augment()``` dari *broom package*. Misalkan outputnya kita sebut sebagai uji.diagnostik (dibahas secara lebih lengkap di Bab 4). 

```{r, echo=TRUE, warning=FALSE}
# menambahkan nilai-nilai dugaan dan residu
library("broom")
uji.diagnostik <- augment(mpm)
head(uji.diagnostik)
```

Kolom-kolom pada tabel diatas menunjukkan

    x: pertumbuhan pendapatan per kapita
    y: penjualan motor
    .fitted: nilai dugaan penjualan motor
    .resid: the residual errors

Kode berikut memplot residuals error (warna merah) yaitu selisih antara nilai pengamatan dengan nilai dugaan. Setiap garis vertikal warna merah menunjukkan nilai kesalahan/residu antara angka penjualan motor aktual dengan nilai dugaannya.

```{r, echo=TRUE, warning=FALSE}
library(ggplot2)
my.formula <- y ~ x
ggplot(uji.diagnostik, aes(x, y)) +
  geom_point() +
  stat_smooth(method = "lm", se = FALSE, formula = my.formula, size = 0.8) +
  geom_segment(aes(xend = x, yend = .fitted), color = "red", size = 0.4, linetype = "dashed")
```

Diagram pencar dan garis regresi juga dapat dapat ditampilkan bersama-sama dengan perintah berikut:

```{r, echo=TRUE, warning=FALSE}
library(ggpmisc)
PJMotor <- as.data.frame(PJMotor)
my.formula <- y ~ x
ggplot(data = PJMotor, aes(x = x, y = y)) +
   geom_smooth(method = "lm", se=FALSE, color="blue", size = 0.8, formula = my.formula) +
   stat_poly_eq(formula = my.formula,
                eq.with.lhs = "italic(hat(y))~`=`~",
                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
                parse = TRUE) +         
   geom_point()

```

Koefisisen determinasi ($R^2$) sebesar 39 persen. Artinya model kita hanya menjelaskan sebesar 39 persen variasi pada penjualan motor. Cukup masuk akal karena model kita hanya menggunakan satu variabel penjelas yaitu pertumbuhan per kapita.  



...work in progress...
