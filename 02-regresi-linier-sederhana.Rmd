# Regresi Linier Sederhana 

Bab ini akan membahas regresi linier sederhana. Istilah regresi sederhana tidak merujuk pada kenaifan penelitiannya tetapi merujuk pada model yang hanya terdiri dari satu variabel respons dan satu variabel prediktor.

Situasi ini sering terjadi pada penelitian sains. Misalnya seorang peneliti ingin memprediksi laju reaksi kimia karena perubahan temperatur, atau ingin mengetahui hubungan antara perubahan diet dengan tingkat kolesterol pada seseorang. Jika dapat diasumsikan bahwa variabel-variabel ini terhubung secara linier, kita dapat menggunakan regresi linier sederhana untuk mengkuantifikasi hubungan ini.

Analisis regresi digunakan ketika solusi eksak tidak tersedia, dalam arti kita tidak akan dapat menemukan nilai tunggal yang dapat mencakup secara lengkap hubungan antara variabel respons dengan prediktornya. Sehingga disini kita mencoba memprediksi setepat mungkin variabel respons atau memprediksi dengan kesalahan terkecil.

Untuk mencapai tujuan ini, kita menganalisis pola-pola variabilitas pada variabel respons dan mencoba melihat apakah variabilitas ini dapat diprediksi dari variabilitas prediktornya.

## Model Regresi Linier Sederhana 

Model regresi linier sederhana dapat dituliskan sebagai berikut:

\begin{equation} 
y_i=\beta_0 + \beta_1x_i+ \epsilon_i
(\#eq:persamaan-umum)
\end{equation}

Regresi sederhana mengindikasikan hanya ada satu variabel prediktor x untuk menduga variabel respons y. Linier disini diartikan modelnya linier pada parameternya dalam hal ini $\beta_0$ dan $\beta_1$. Jadi model $y_i = \beta_0 + \beta_1{x_i}^2 + \epsilon_i$ adalah linier pada $\beta_0$ dan $\beta_1$, sementara model $y_i = \beta_0 + e^{\beta_ix_i} + \epsilon_i$ tidak linier.

Misalkan kita memiliki pasangan-pasangan data sampel sebanyak n yang diambil secara acak dari populasi yang lebih besar $(x_1,y_1), (x_2,y_2), ⋯, (x_n,y_n)$. Tujuan dari analisis regresi linier adalah menemukan model terbaik yaitu menemukan nilai $\beta_0$ and $\beta_1$ yang menghasilkan garis paling cocok dengan titik-titik data yang kita punyai. 

Dengan kata lain tujuan dari analisis regresi adalah mengestimasi koefisien regresi untuk variabel prediktor sehingga didapatkan nilai dugaan variabel respons sedekat mungkin nilainya dengan nilai pengamatan aktualnya. 

Di dalam analisis regresi, model terbaik ditunjukkan oleh garis lurus yang menghubungkan rata-rata variabel prediktor dengan variabel respons sedemikian rupa sehingga jumlah kuadrat kesalahan (jarak vertikal antara titik-titik data pengamatan aktual $y_i$ dengan nilai dugaannya $\hat y_i$) minimal. 

Untuk memperoleh nilai dugaan $\beta_0$ dan $\beta_1$ yang paling cocok, kita menggunakan metode kuadrat terkecil (*method of least squares*). Dengan pendekatan kuadrat terkecil, kita mencari nilai dugaan $\beta_0$ dan $\beta_1$ yang meminimalkan jumlah kuadrat residu/kesalahan ($y_i-\hat y_i$).

### Kasus 1: Penjualan Motor dan Pertumbuhan Pendapatan Perkapita

Kita akan melanjutkan kasus hubungan antara penjualan motor dengan pendapatan pada Bab 1 sebelumnya sebagai ilustrasi regresi linier sederhana. Data dapat diunduh di [sini](https://drive.google.com/file/d/1Aa6A0KkXXINoDkdNJSnYUY5Y0E1xnrOb/view?usp=sharing). Langkah awal untuk melihat bagaimana hubungan antar variabel adalah membuat diagram pencar.

Plot sangat penting di dalam regresi. Pemeriksaan diagram pencar secara teliti harus mendahului penghitungan regresi. Diagram pencar dapat mengindikasikan apakah model regresi yang diinginkan mungkin masuk akal atau tidak. Kesepakatan dalam membuat diagram pencar, variabel $x$ sebagai variabel penjelas diplot pada sumbu horisontal. Varibel $y$ sebagai variabel respons diplot pada sumbu vertikal. 

Untuk membuat diagram pencar, hal pertama yang harus dilakukan adalah memasukkan data ke dalam R, mengecek apakah data yang kita masukkan sudah betul dan memanggil *package* yang relevan dengan model yang akan dibuat.

```{r, echo=TRUE}
# memanggil data yang disimpan dalam bentuk teks ke dalam R
PJMotor <- read.delim("PJMotor.txt") 
PJMotor <- as.data.frame(PJMotor)

```

```{r, echo=TRUE}
# untuk melihat beberapa baris data teratas
head(PJMotor) 
```

```{r, echo=TRUE}
# untuk melihat beberapa baris data terakhir
tail(PJMotor) 
```

Data yang kita masukkan kelihatan seperti yang diharapkan. Variabel penjualan dan pendapatan semua dibaca sebagai angka (*numeric data type*). Selanjutnya kita akan lihat struktur dan ringkasan persebaran datanya.  

```{r, echo=TRUE}
# melihat struktur data
str(PJMotor)
```
Hasil fungsi ```str()``` menunjukkan bahwa data ini adalah data *time series* terdiri dari tiga kolom yaitu penjualan motor (y), pertumbuhan pendapatan per kapita (x) dan tahun selama 19 tahun dari 2001-2019. 

```{r, echo=TRUE}
# melihat ringkasan data kecuali data tahun
summary(subset(PJMotor, select = c(y,x)))
```

Selanjutnya kita cek normalitas data, korelasi dan diagram pencar antara pasangan data $y$ dengan $x$ seperti yang ditunjukkan pada Gambar 2.1. 

```{r plotpasangan-pjmotor, echo=TRUE, fig.cap = {"Plot Pasangan Data Penjualan dan Pendapatan"}, fig.align = "center"}
library (GGally)
GGally::ggpairs(subset(PJMotor, select = c(y,x)))
```

Pada diagonal, kita melihat distribusi data $y$ dan $x$: data kedua variabel menceng ke kiri (*skewed left*). Di atas diagonal ditunjukkan nilai korelasi antara $y$ dan $x$ yaitu sebesar=0.625. Koefisisen korelasi nilainya antara −1 (berkorelasi negatif sempurna) melalui 0 (tidak ada korelasi) sampai +1 (berkorelasi positif sempurna). Korelasi antara penjualan dan pendapatan disini positif cukup kuat dan signifikan. Grafik dibawah diagonal menunjukkan diagram pencar antara pasangan data $y$ dengan $x$ seperti yang sudah kita bahas sebelumnya di Bab 1.

Di dalam R model regresi linier sederhana dapat diperoleh dengan perintah ```lm(y~x)```. Tanda ~ dapat diartikan $y$ dijelaskan oleh $x$ atau $y$ fungsi dari $x$. Fungsi ini mengestimasi koefisien regresi model linier dengan metode kuadrat terkecil (*the least squares method*). 

Semisal modelnya kita beri nama **model penjualan motor (mpm)**, yang memodelkan hubungan antara penjualan motor ($y$) dengan pertumbuhan pendapatan ($x$), maka model ini dapat diperoleh dengan perintah:

```{r regresi-mpm, echo=TRUE}
mpm <- lm(y ~ x)
# Perhatikan tanda panah ke kiri. 
# Intersep dan slope secara default diestimasi. 
# Bandingkan dengan perintah untuk mendapatkan diagram pencar. 
```

Perintah ini sama dengan persamaan dibawah:

$$ y = β_0 + β_1x + ε $$

Kita kemudian menggunakan perintah ```summary()``` untuk menampilkan luarannya. Hasilnya adalah sebagai berikut:

```{r summary-mpm, echo=TRUE}
# perintah summary() untuk mengekstrak hasil regresi
summary (mpm) 
```

Persamaan regresinya dapat diringkas sebagai $penjualan=-1.21+1.73pendapatan$. Nilai dugaan intersep garis regresi $\hat \beta_0$ = -1.210 (SE= 2.088), p-value = 0.57 (tidak signifikan). Nilai -1,21 menunjukkan dugaan penjualan sepeda motor (y dalam juta unit) jika pertumbuhan pendapatan per kapita sebesar 0 persen. Angka penjualan tidak mungkin negatif, paling rendah adalah 0. Jadi dalam kasus ini, nilai intersep dari model yang kita duga tidak mempunyai interpretasi yang berarti. Jadi intersep di dalam sebuah persamaan kadang-kadang mempunyai interpretasi yang berarti kadang juga tidak seperti dalam kasus kita ini. 

Sedangkan nilai dugaan variabel prediktor pendapatan $\hat \beta_1$ = 1.733 (SE = 0.525) dan p-valuenya (menguji hipotesis nol bahwa $\beta_1$ = 0) kecil (signifikan), konsisten dengan bukti persebaran data yang cenderung linier. Jadi 1.733 adalah nilai kemiringan garis regresi yang menunjukkan untuk setiap perubahan pertumbuhan pendapatan per kapita sebesar 1%, berkaitan dengan perubahan penjualan motor sebesar 1.73 juta unit. Jika terjadi kenaikan pertumbuhan pendapatan per kapita sebesar 1 persen, ini berkaitan dengan peningkatan penjualan motor sebanyak 1.73 juta unit. 

Output lain yang penting dari perintah ```summary()``` adalah koefisisen determinasi ($R^2$) sebesar 39 persen. Artinya model kita menjelaskan sebesar 39 persen variasi pada data penjualan motor. Cukup masuk akal karena model kita hanya menggunakan satu variabel penjelas yaitu pertumbuhan per kapita. Selang kepercayaan batas atas dan batas bawah (95% defaultnya) dapat diperoleh dengan perintah ```confint()```.

```{r selang-kepercayaan, echo=TRUE}
# perintah menampilkan selang kepercayaan
confint(mpm)
```

Terlihat bahwa selang kepercayaan untuk intersep meliputi angka 0 (tidak signifikan), sedangkan koefisien untuk pendapatan tidak meliputi 0 (signifikan).

Selanjutnya kita bisa melihat nilai-nilai dugaan dan residu dengan model yang diperoleh dengan menggunakan perintah ```augment()``` dari *broom package*. Misalkan output dari perintah ```augment()``` kita sebut sebagai uji.diagnostik (dibahas secara lebih lengkap di Bab 4): 

```{r, echo=TRUE, warning=FALSE}
# menambahkan nilai-nilai dugaan dan residu
# library perlu dipanggil jika belum dipanggil sebelumnya
# library("broom") 
uji.diagnostik <- augment(mpm)
head(uji.diagnostik)
```

Kolom-kolom pada tabel diatas menunjukkan

    x: pertumbuhan pendapatan per kapita
    y: penjualan motor
    .fitted: nilai dugaan penjualan motor
    .resid: the residual errors

Kode berikut memplot nilai residu (warna merah) yaitu selisih antara nilai pengamatan aktual dengan nilai dugaan. Setiap garis vertikal warna merah menunjukkan nilai residu antara data penjualan motor aktual dengan nilai dugaannya.

```{r plot-residu-mpm, echo=TRUE, warning=FALSE, fig.cap={"Garis dan Persamaan Regresi"}, fig.align="center"}
# library tidak perlu dipanggil lagi jika sudah dipanggil sebelumnya
# library(ggplot2) 
# library(ggpmisc)
rumus <- y ~ x
ggplot(uji.diagnostik, aes(x, y)) +
  geom_point() +
  stat_smooth(method = "lm", se = FALSE, formula = rumus, size = 0.8) +
  geom_segment(aes(xend = x, yend = .fitted), color = "red", size = 0.4, linetype = "dashed") + 
  theme_bw()+
   stat_poly_eq(formula = rumus,
                eq.with.lhs = "italic(hat(y))~`=`~",
                aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")), 
                parse = TRUE) 
```



::: {.rmdnote}
*work in progress*...sedang dalam proses pengerjaan
:::
